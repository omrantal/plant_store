import{u as y,r as O}from"./index-7944a1b6.js";import{u as _}from"./usePlantsContext-67d54dea.js";const C=()=>{const{user:o}=y(),{dispatch:l}=_(),[u,d]=O.useState(!1),[f,P]=O.useState(!1),S=async({_id:r,name:a,image:i,type:c,price:e})=>{if(o&&!u){d(!0);const s=JSON.parse(localStorage.getItem(`${o.email}_cart`))||[];if(s.find(t=>t.name===a))await m({id:r,change:"add"});else{const t=[...s,{_id:r,name:a,image:i,type:c,price:e,numOfPieces:1,priceForPiece:e}];localStorage.setItem(`${o.email}_cart`,JSON.stringify(t)),l({type:"ADD_TO_CART",payload:{_id:r,name:a,image:i,type:c,price:e,numOfPieces:1,priceForPiece:e}})}d(!1)}},m=async({id:r,change:a})=>{if(!f){P(!0);const c=JSON.parse(localStorage.getItem(`${o.email}_cart`)).map(e=>{if(e._id===r){let s,n;const{numOfPieces:t,price:p,priceForPiece:g}=e;if(a==="add")s=t+1,n=p+g;else{if(t===1)return null;s=t-1,n=p-g}return l({type:"UPDATE_IN_CART",payload:{...e,change:a}}),{...e,numOfPieces:s,price:n}}return e});localStorage.setItem(`${o.email}_cart`,JSON.stringify(c)),P(!1)}};return{addLoading:u,updateLoading:f,addPlantToCart:S,updatePlantInCart:m}};export{C as u};
