import{u as C,r as p,b as f}from"./index-ff9d9ac4.js";import{u as g}from"./usePlantsContext-dbcb686b.js";const m=()=>{const{user:n}=C(),{plantsInCart:h,dispatch:d}=g(),[i,c]=p.useState(!1),[u,o]=p.useState(!1),A=async({_id:a,name:e})=>{if(n&&!i){if(c(!0),h.find(s=>s.name===e))await l({id:a,change:"add"});else{let s=a;await f.post(`/api/cart/${s}`,{},{headers:{Authorization:`Bearer ${n.token}`}}).then(r=>{d({type:"ADD_TO_CART",payload:r.data})}).catch(r=>{console.log(r)})}c(!1)}},l=async({id:a,change:e})=>{u||(o(!0),await f.put(`/api/cart/${a}`,{change:e},{headers:{Authorization:`Bearer ${n.token}`}}).then(t=>{if(t.data===null){o(!1);return}d({type:"UPDATE_IN_CART",payload:{...t.data,change:e}})}).catch(t=>{console.log(t)}),o(!1))};return{addLoading:i,updateLoading:u,addPlantToCart:A,updatePlantInCart:l}};export{m as u};
